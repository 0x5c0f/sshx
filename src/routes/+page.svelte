<script lang="ts">
  import {
    CastIcon,
    DownloadIcon,
    GitBranchIcon,
    HardDriveIcon,
    ImageIcon,
    LockIcon,
    PackageIcon,
    RefreshCwIcon,
    Share2Icon,
  } from "svelte-feather-icons";

  import logotypeDark from "$lib/assets/logotype-dark.svg";
  import landingGraphic from "$lib/assets/landing-graphic.svg";
  import landingBackground from "$lib/assets/landing-background.svg";
  import TeaserVideo from "$lib/ui/TeaserVideo.svelte";
  import CopyableCode from "$lib/ui/CopyableCode.svelte";
  import DownloadLink from "$lib/ui/DownloadLink.svelte";

  let installationEl: HTMLDivElement;

  const socials = [
    {
      title: "ğŸ¤–\xa0 GitHub",
      href: "https://github.com/ekzhang/sshx",
    },
    {
      title: "ğŸŒ¸\xa0 Twitter",
      href: "https://twitter.com/ekzhang1",
    },
    {
      title: "ğŸ’Œ\xa0 Email",
      href: "mailto:ekzhang1@gmail.com",
    },
    {
      title: "ğŸŒ\xa0 Website",
      href: "https://www.ekzhang.com",
    },
  ];

  function scrollToInstallation() {
    installationEl.scrollIntoView({ behavior: "smooth" });
  }
</script>

<main
  class="max-w-screen-xl mx-auto px-4 md:px-8 lg:px-16 text-zinc-100 overflow-x-hidden"
>
  <header class="mt-6 mb-4 sm:my-8 md:my-12">
    <img class="h-12 sm:h-16 -mx-1" src={logotypeDark} alt="sshx logo" />
  </header>
  <h1
    class="font-medium text-3xl sm:text-4xl md:text-5xl max-w-[26ch] py-2 mb-6 md:mb-0 sm:tracking-tight leading-[1.15]"
  >
    ä¸€ä¸ªå®‰å…¨çš„åŸºäºç½‘é¡µçš„ï¼Œ
    <span class="title-gradient">åä½œ</span> ç»ˆç«¯
  </h1>

  <div class="relative">
    <div
      class="absolute scale-150 md:scale-100 md:left-[180px] md:top-[-200px] md:w-[1000px] -z-10"
    >
      <img class="select-none" src={landingBackground} alt="" />
    </div>
    <div class="md:absolute md:left-[500px] md:w-[1000px]">
      <img
        class="mt-5 mb-8 w-[720px]"
        width={813}
        height={623}
        src={landingGraphic}
        alt="ä¸¤ä¸ªç»ˆç«¯çª—å£è¿è¡Œ sshx å’Œä¸‰ä¸ªå®æ—¶å…‰æ ‡"
      />
    </div>
  </div>

  <section class="my-12 space-y-6 sm:text-lg md:max-w-[460px] text-zinc-400">
    <p>
      <code class="name">sshx</code> è®©æ‚¨é€šè¿‡é“¾æ¥ä¸ä»»ä½•äººå…±äº«ç»ˆç«¯ï¼ŒåŸºäº 
      <b>å¤šäººæ— é™ç”»å¸ƒ</b>ã€‚
    </p>
    <p>
      å®ƒå…·æœ‰<b>å®æ—¶åä½œ</b>ï¼Œæ”¯æŒè¿œç¨‹å…‰æ ‡å’ŒèŠå¤©ã€‚å®ƒä¹Ÿ<b>å¿«é€Ÿ</b>å¹¶ä¸”<b>ç«¯åˆ°ç«¯åŠ å¯†</b>ï¼Œé‡‡ç”¨ç”¨ Rust ç¼–å†™çš„è½»é‡çº§æœåŠ¡å™¨ã€‚
    </p>
    <p>
      ä½¿ç”¨å•ä¸ªå‘½ä»¤å®‰è£… <code class="name">sshx</code>ã€‚é€‚ç”¨äºæ•™å­¦ã€è°ƒè¯•æˆ–äº‘è®¿é—®ã€‚
    </p>
  </section>

  <div class="pb-12 md:pb-36">
    <button
      class="bg-pink-700 hover:bg-pink-600 active:ring-4 active:ring-pink-500/50 text-lg font-medium px-8 py-2 rounded-full"
      on:click={scrollToInstallation}
    >
      å¼€å§‹ä½¿ç”¨
    </button>
  </div>

  <div class="mt-8 md:mt-32 grid md:grid-cols-2 xl:grid-cols-3 gap-4 md:gap-6">
    <div class="feature-block">
      <div class="feature-icon">
        <CastIcon size="14" />
      </div>
      <h3>åä½œ</h3>
      <p>é€šè¿‡å…±äº«ä¸€ä¸ªå®‰å…¨çš„ç‹¬ç‰¹æµè§ˆå™¨é“¾æ¥é‚€è¯·ä»–äººã€‚</p>
    </div>
    <div class="feature-block">
      <div class="feature-icon">
        <LockIcon size="14" />
      </div>
      <h3>ç«¯åˆ°ç«¯åŠ å¯†</h3>
      <p>å®‰å…¨å‘é€æ•°æ®ï¼›æœåŠ¡å™¨æ°¸è¿œæ— æ³•çœ‹åˆ°æ‚¨è¾“å…¥çš„å†…å®¹ã€‚</p>
    </div>
    <div class="feature-block">
      <div class="feature-icon">
        <HardDriveIcon size="14" />
      </div>
      <h3>è·¨å¹³å°</h3>
      <p>åœ¨ macOSã€Linux å’Œ Windows ä¸Šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ã€‚</p>
    </div>
    <div class="feature-block">
      <div class="feature-icon">
        <ImageIcon size="14" />
      </div>
      <h3>æ— é™ç”»å¸ƒ</h3>
      <p>ä¸€æ¬¡ç§»åŠ¨å’Œè°ƒæ•´å¤šä¸ªç»ˆç«¯çš„å¤§å°ï¼Œä»»ä½•æ’åˆ—æ–¹å¼å‡å¯ã€‚</p>
    </div>
    <div class="feature-block">
      <div class="feature-icon">
        <RefreshCwIcon size="14" />
      </div>
      <h3>å®æ—¶å­˜åœ¨</h3>
      <p>åœ¨åº”ç”¨ç¨‹åºä¸­æŸ¥çœ‹å…¶ä»–äººçš„åå­—å’Œå…‰æ ‡ã€‚</p>
    </div>
    <div class="feature-block">
      <div class="feature-icon">
        <Share2Icon size="14" />
      </div>
      <h3>è¶…å¿«é€Ÿç½‘çŠ¶ç½‘ç»œ</h3>
      <p>
        ä»ä»»ä½•åœ°æ–¹è¿æ¥åˆ°å…¨çƒç½‘ç»œä¸­çš„æœ€è¿‘åˆ†å¸ƒå¼å¯¹ç­‰èŠ‚ç‚¹ã€‚
      </p>
    </div>
  </div>

  <div class="my-48 hidden md:block">
    <TeaserVideo />
  </div>

  <h2
    bind:this={installationEl}
    class="mt-32 mb-12 font-medium text-3xl sm:text-4xl md:text-center scroll-mt-16"
  >
    å®‰è£…
  </h2>

  <section class="installation-section">
    <h3 class="text-xl sm:text-lg">
      <DownloadIcon size="20" class="text-zinc-400 inline-block mr-1 mb-0.5" />
      macOS / Linux
    </h3>
    <div class="text-sm text-zinc-400 md:text-base md:pt-0.5">
      <p class="mb-3">åœ¨æ‚¨çš„ç»ˆç«¯ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
      <CopyableCode value="curl -sSf https://sshx.io/get | sh" />

      <p class="mt-8 mb-3">æˆ–è€…ï¼Œä¸‹è½½é€‚åˆæ‚¨å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</p>
      <div class="flex flex-wrap gap-2 mb-2">
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-aarch64-apple-darwin.tar.gz"
          >macOS ARM64 (è‹¹æœèŠ¯ç‰‡)</DownloadLink
        >
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-x86_64-apple-darwin.tar.gz"
          >macOS x86-64 (è‹±ç‰¹å°”)</DownloadLink
        >
      </div>
      <div class="flex flex-wrap gap-2 mb-2">
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-aarch64-unknown-linux-musl.tar.gz"
          >Linux ARM64</DownloadLink
        >
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-x86_64-unknown-linux-musl.tar.gz"
          >Linux x86-64</DownloadLink
        >
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-arm-unknown-linux-musleabihf.tar.gz"
          >Linux ARMv6</DownloadLink
        >
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-armv7-unknown-linux-musleabihf.tar.gz"
          >Linux ARMv7</DownloadLink
        >
      </div>
      <div class="flex flex-wrap gap-2">
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-x86_64-unknown-freebsd.tar.gz"
          >FreeBSD x86-64</DownloadLink
        >
      </div>
    </div>
  </section>

  <section class="installation-section">
    <h3 class="text-xl sm:text-lg">
      <DownloadIcon size="20" class="text-zinc-400 inline-block mr-1 mb-0.5" />
      Windows
    </h3>
    <div class="text-sm text-zinc-400 md:text-base md:pt-0.5">
      <p class="mb-3">ä¸‹è½½é€‚åˆæ‚¨å¹³å°çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>

      <div class="flex flex-wrap gap-2">
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-x86_64-pc-windows-msvc.zip"
          >Windows x86-64</DownloadLink
        >
        <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-i686-pc-windows-msvc.zip"
          >Windows x86</DownloadLink
        >
        <!-- <DownloadLink
          href="https://sshx.s3.amazonaws.com/sshx-aarch64-pc-windows-msvc.zip"
          >Windows ARM64</DownloadLink
        > -->
      </div>
    </div>
  </section>

  <section class="installation-section">
    <h3 class="text-xl sm:text-lg">
      <PackageIcon size="20" class="text-zinc-400 inline-block mr-1 mb-0.5" />
      ä»æºä»£ç æ„å»º
    </h3>
    <div class="text-sm text-zinc-400 md:text-base md:pt-0.5">
      <p class="mb-3">
        ç¡®ä¿æ‚¨æ‹¥æœ‰æœ€æ–°ç‰ˆæœ¬çš„ Rust å’Œ protocã€‚ç¼–è¯‘ sshx å¹¶å°†å…¶æ·»åŠ åˆ°ç³»ç»Ÿè·¯å¾„ä¸­ã€‚
      </p>
      <CopyableCode value="cargo install sshx" />
    </div>
  </section>

  <section class="installation-section">
    <h3 class="text-xl sm:text-lg">
      <GitBranchIcon size="20" class="text-zinc-400 inline-block mr-1 mb-0.5" />
      GitHub Actions
    </h3>
    <div class="text-sm text-zinc-400 md:text-base md:pt-0.5">
      <p class="mb-3">
        åœ¨ GitHub Actions æˆ–å…¶ä»– CI æä¾›å•†ä¸Šï¼Œè¿è¡Œæ­¤å‘½ä»¤ã€‚å®ƒå°†æš‚åœæ‚¨çš„å·¥ä½œæµå¹¶å¼€å§‹åä½œä¼šè¯ã€‚
      </p>
      <CopyableCode value="curl -sSf https://sshx.io/get | sh -s run" />
    </div>
  </section>

  <hr class="mt-32 mb-12" />

  <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6 mb-6">
    {#each socials as social}
      <a
        target="_blank"
        rel="noreferrer"
        href={social.href}
        class="border border-white/10 hover:border-white/30 transition-colors p-4 text-center text-lg font-medium rounded-lg"
      >
        {social.title}
      </a>
    {/each}
  </div>

  <p class="mb-12 text-center text-zinc-400">
    å¼€æºï¼Œ&copy; Eric Zhang 2023
  </p>
</main>

<style lang="postcss">
  b {
    @apply text-zinc-300 font-medium;
  }

  code.name {
    @apply text-[0.9em] text-zinc-100 border border-white/25 px-1 py-0.5 rounded;
  }

  hr {
    @apply mx-auto md:w-1/2 border-zinc-800;
  }

  .title-gradient {
    @apply text-transparent bg-clip-text bg-gradient-to-r from-fuchsia-400 to-blue-500;
  }

  .feature-block {
    @apply relative border rounded-lg border-transparent p-6 sm:p-8;
    background: #111111 padding-box;
  }

  .feature-block::before {
    content: "";
    @apply absolute inset-0;
    z-index: -1;
    margin: -1px;
    border-radius: inherit;
    background: linear-gradient(
      160deg,
      rgba(255, 255, 255, 0.36) 5%,
      rgba(255, 255, 255, 0.08) 25%,
      rgba(255, 255, 255, 0.24) 50%,
      rgba(255, 255, 255, 0.08) 75%,
      rgba(255, 255, 255, 0.28) 95%
    );
    opacity: 0.5;
    transition: opacity 200ms;
  }

  .feature-block:hover::before {
    opacity: 1;
  }

  .feature-block h3 {
    @apply font-medium mb-2;
  }

  .feature-block p {
    @apply text-zinc-400;
  }

  .feature-icon {
    @apply inline-block p-3 rounded-full mb-3 shadow-md border border-zinc-600;
  }

  .installation-section {
    @apply grid sm:grid-cols-[200px,1fr] gap-x-10 gap-y-4 max-w-4xl mx-auto sm:border-t sm:border-white/10 sm:py-6 lg:px-2;
    @apply mb-16 lg:mb-8;
  }
</style>
